<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/main-page.css">
    <link rel="stylesheet" href="/css/cart.css">
    <script src="/js/cart-functions.js"></script>
    <script src="/js/product-functions.js"></script>
    <title>Laruan ATBP</title>
</head>
<body>    
   
    <h1 id="title-page"><a href="products-page.html">< Products</a></h1>

<!--HEADER CODE ABOVE-->


<h1 id="title-cart">My Shopping Cart</h1>

<div class="row-info">
    <p id="description">Description</p>
    <ul>
    <li>Quantity</li>
    <li>Remove</li>
    <li>Price</li>
</ul>
</div>

<hr id="cart-line">

<!---STORE PRODUCT INFO BELOW WHEN LEAVING SITE-->



<div class="product">
<div class="showZoro" id="showZoro">
<div class="product-info">
    <p id="productName" class="productName">Zoro Unlimited</p>
    <button id="incrementButton" class="incrementButton">+</button>
    <div id="quantityContainer" class="quantityContainer">
        <p id="number" class="quantityContainer">1</p>
    </div>
    <button id="decrementButton" class="decrementButton">-</button>
    <button id="removeButton" class="removeButton">X</button>
    <p id="priceProduct" class="priceProduct">₱1,000.00</p>
</div>
<hr id="cart-line">
</div>
</div>

<div class="product">
    <div class="showLuffy" id="showLuffy">
    <div class="product-info">
        <p id="productName" class="productName">Luffy Unlimited</p>
        <button id="incrementButton" class="incrementButton">+</button>
        <div id="quantityContainer" class="quantityContainer">
            <p id="number" class="quantityContainer">1</p>
        </div>
        <button id="decrementButton" class="decrementButton">-</button>
        <button id="removeButtonLuffy" class="removeButton">X</button>
        <p id="priceProduct" class="priceProduct">₱1,000.00</p>
    </div>
    <hr id="cart-line">
    </div>
    </div>

    <div class="product">
        <div class="showSanji" id="showSanji">
        <div class="product-info">
            <p id="productName" class="productName">Sanji Unlimited</p>
            <button id="incrementButton" class="incrementButton">+</button>
            <div id="quantityContainer" class="quantityContainer">
                <p id="number" class="quantityContainer">1</p>
            </div>
            <button id="decrementButton" class="decrementButton">-</button>
            <button id="removeButtonSanji" class="removeButton">X</button>
            <p id="priceProduct" class="priceProduct">₱1,000.00</p>
        </div>
        <hr id="cart-line">
        </div>
        </div>


        <div class="product">
            <div class="showGarp" id="showGarp">
            <div class="product-info">
                <p id="productName" class="productName">Garp Unlimited</p>
                <button id="incrementButton" class="incrementButton">+</button>
                <div id="quantityContainer" class="quantityContainer">
                    <p id="number" class="quantityContainer">1</p>
                </div>
                <button id="decrementButton" class="decrementButton">-</button>
                <button id="removeButtonGarp" class="removeButton">X</button>
                <p id="priceProduct" class="priceProduct">₱1,000.00</p>
            </div>
            <hr id="cart-line">
            </div>
            </div>
    
            <div class="product">
                <div class="showBorsalino" id="showBorsalino">
                <div class="product-info">
                    <p id="productName" class="productName">Borsalino Unlimited</p>
                    <button id="incrementButton" class="incrementButton">+</button>
                    <div id="quantityContainer" class="quantityContainer">
                        <p id="number" class="quantityContainer">1</p>
                    </div>
                    <button id="decrementButton" class="decrementButton">-</button>
                    <button id="removeButtonBorsalino" class="removeButton">X</button>
                    <p id="priceProduct" class="priceProduct">₱1,000.00</p>
                </div>
                <hr id="cart-line">
                </div>
                </div>
    
                <div class="product">
                    <div class="showAokiji" id="showAokiji">
                    <div class="product-info">
                        <p id="productName" class="productName">Aokiji Unlimited</p>
                        <button id="incrementButton" class="incrementButton">+</button>
                        <div id="quantityContainer" class="quantityContainer">
                            <p id="number" class="quantityContainer">1</p>
                        </div>
                        <button id="decrementButton" class="decrementButton">-</button>
                        <button id="removeButtonAokiji" class="removeButton">X</button>
                        <p id="priceProduct" class="priceProduct">₱1,000.00</p>
                    </div>
                    <hr id="cart-line">
                    </div>
                    </div>
    
                    
                    <div class="product">
                        <div class="showMihawk" id="showMihawk">
                        <div class="product-info">
                            <p id="productName" class="productName">Mihawk Unlimited</p>
                            <button id="incrementButton" class="incrementButton">+</button>
                            <div id="quantityContainer" class="quantityContainer">
                                <p id="number" class="quantityContainer">1</p>
                            </div>
                            <button id="decrementButton" class="decrementButton">-</button>
                            <button id="removeButtonMihawk" class="removeButton">X</button>
                            <p id="priceProduct" class="priceProduct">₱1,000.00</p>
                        </div>
                        <hr id="cart-line">
                        </div>
                        </div>
                

                            <div class="product">
                                <div class="showDoflamingo" id="showDoflamingo">
                                <div class="product-info">
                                    <p id="productName" class="productName">Doflamingo Unlimited</p>
                                    <button id="incrementButton" class="incrementButton">+</button>
                                    <div id="quantityContainer" class="quantityContainer">
                                        <p id="number" class="quantityContainer">1</p>
                                    </div>
                                    <button id="decrementButton" class="decrementButton">-</button>
                                    <button id="removeButtonDoflamingo" class="removeButton">X</button>
                                    <p id="priceProduct" class="priceProduct">₱1,000.00</p>
                                </div>
                                <hr id="cart-line">
                                </div>
                                </div>
                                
                                <div class="product">
                                    <div class="showBoa" id="showBoa">
                                    <div class="product-info">
                                        <p id="productName" class="productName">Boa Unlimited</p>
                                        <button id="incrementButton" class="incrementButton">+</button>
                                        <div id="quantityContainer" class="quantityContainer">
                                            <p id="number" class="quantityContainer">1</p>
                                        </div>
                                        <button id="decrementButton" class="decrementButton">-</button>
                                        <button id="removeButtonBoa" class="removeButton">X</button>
                                        <p id="priceProduct" class="priceProduct">₱1,000.00</p>
                                    </div>
                                    <hr id="cart-line">
                                    </div>
                                    </div>


                                    <div class="checkout-button">
                                        <input type="submit" id="checkout-button" value="Checkout" onclick="checkOutButtonClick()">
                                    </div>
                                    
<script>

    window.onload = function() {
    var showCheckoutButton = sessionStorage.getItem("showCheckoutButton");
    if (showCheckoutButton === "true") {
        document.getElementById("checkout-button").style.display = "block"; // Show the checkout button
    }
};
    </script>

                                    <script>
                                        document.addEventListener("DOMContentLoaded", function() {
                                        // Load cart items from localStorage
                                        loadCart();
                                    });
                                    
                                    function loadCart() {
                                        var cartItems = JSON.parse(localStorage.getItem("cart")) || [];
                                        displayCart(cartItems);
                                    }
                                    
                                    function displayCart(cartItems) {
                                        var cartDiv = document.getElementById("cart");
                                        cartDiv.innerHTML = ""; // Clear previous content
                                    
                                        cartItems.forEach(function(item) {
                                            if (localStorage.getItem(item.name + '_quantity')) {
                                                var productDiv = document.createElement("div");
                                                productDiv.textContent = item.name + " - " + item.price;
                                                cartDiv.appendChild(productDiv);
                                            }
                                        });
                                    }
                                    
                                    // Example: Adding an item to the cart
                                    function addItemToCart(name, price) {
                                        var cartItems = JSON.parse(localStorage.getItem("cart")) || [];
                                        cartItems.push({ name: name, price: price });
                                        localStorage.setItem("cart", JSON.stringify(cartItems));
                                        loadCart(); // Update cart display
                                    }
                                    </script>

<script>
    // Get all product elements
const products = document.querySelectorAll('.product');

// Iterate over each product
products.forEach(product => {
    // Get elements for the current product
    const incrementButton = product.querySelector('.incrementButton');
    const decrementButton = product.querySelector('.decrementButton');
    const removeButton = product.querySelector('.removeButton');
    const quantityContainer = product.querySelector('.quantityContainer');
    const priceElement = product.querySelector('.priceProduct');
    const productName = product.querySelector('.productName');

    // Initialize quantity and total price from localStorage, or use default values if not found
    let quantity = parseInt(localStorage.getItem(productName.textContent + '_quantity')) || 1;
    let totalPrice = parseFloat(localStorage.getItem(productName.textContent + '_totalPrice')) || 1000;

    // Update quantity and total price
    function updateQuantityAndPrice(change) {
        if (quantity + change <= 5 && quantity + change >= 1) {
            quantity += change;
            totalPrice += change * 1000;

            // Update localStorage with new values
            localStorage.setItem(productName.textContent + '_quantity', quantity);
            localStorage.setItem(productName.textContent + '_totalPrice', totalPrice);

            quantityContainer.textContent = quantity;
            priceElement.textContent = `₱${totalPrice.toFixed(2)}`;
        } else if (quantity + change > 5) {
            // Show a pop-up indicating that only 5 products are available
            alert("There are only 5 products available.");
        }
    }

    // Load initial values
    quantityContainer.textContent = quantity;
    priceElement.textContent = `₱${totalPrice.toFixed(2)}`;

    // Increment button click event
    incrementButton.addEventListener('click', () => {
        updateQuantityAndPrice(1);
    });

    // Decrement button click event
    decrementButton.addEventListener('click', () => {
        if (quantity > 1) {
            updateQuantityAndPrice(-1);
        }
    });


    function removeFromCart(productName) {
    var cartItems = JSON.parse(localStorage.getItem("cart")) || [];
    // Find index of item with given name
    var index = cartItems.findIndex(item => item.name === productName);
    if (index !== -1) {
        // Remove item from array
        cartItems.splice(index, 1);
        // Update local storage
        localStorage.setItem("cart", JSON.stringify(cartItems));
    }
}
    // Remove button click event
    removeButton.addEventListener('click', () => {

    localStorage.removeItem(productName.textContent + '_quantity');
    localStorage.removeItem(productName.textContent + '_totalPrice');

    // Remove the corresponding item from sessionStorage
    

    // Remove the item from the cart in localStorage
    console.log("Remove button clicked for:", productName.textContent);
    removeFromCart(productName.textContent);
    // Remove the current product div from the DOM
    removeButton.parentElement.parentElement.remove();  
    alert("Product removed successfully");

    });
    
});
</script>

<script>
    function restoreSessionFromLocalStorage() {
        const email = localStorage.getItem('currentUserEmail');
        if (email) {
            // Restore email from localStorage to sessionStorage
            sessionStorage.setItem('email', email);
        }
    }

    // Call the function to restore session data from localStorage when the page loads
    window.onload = function () {
        restoreSessionFromLocalStorage();
    };
</script>

<br><br>



                    <!--------HIDDEN ELEMENTS ABOVE-->


</body>
</html>